var express = require('../express');
var _ = require('../underscore');

var vakoo = function(options){

    var opts = {
        port:8773,
        defaultController:'main'
    }

    if(typeof options != "undefined"){
        for(key in options){
            if(typeof opts[key] != "undefined"){
                opts[key] = options[key];
            }
        }
    }

    _this = this;

    this._express = express();

    this._ = _;

    this.core = require('./core')(this);

    this.router = this.core.router();

    this.listen = function(port){

        if(typeof port == "undefined"){
            port = opts.port;
        }

        _this._express.all('*',function(req,res){
            _this.router.execute(req,res);
        })

        _this._express.listen(port);
    };

    return this;
};


module.exports = vakoo;